angular.module("baseApp.shared").factory("bladeService",["uuid",function(a){"use strict";var b={},c={},d={},e=[],f=function(a){for(var b=_.find(e,function(b){return b.id===a}),c=e.indexOf(b),d=e.length,f=0;d-1-c>f;f++)e.pop()};return{activeBlades:e,addNewActiveBlade:function(c,d,f,g){var h=_.clone(b[c]);h.id=a.generate(),h.params=f,g&&(h.title=g),d&&(h.defaultState=d),e.push(h)},setMaxBlade:function(a){c.bladeTypeScope&&c.bladeTypeScope.id!==a.bladeTypeScope.id&&c.open(),c!==a&&(c=a)},generateUrl:function(){return e.reduce(function(a,b){return a+b.typeName+"/"+b.state+"/"},"")},setUrl:function(a){for(var b=a.split("/"),c=0;c<b.length;){var e=b[c++],f=b[c++];d[e]={},d[e].state=f}},getMaxBlade:function(){return c},destroyBlades:function(){c={},d={},b={},e.length=0},addType:function(a,c){b[a.typeName]=a,b[a.typeName].template=c,d[a.typeName]&&this.addNewActiveBlade(b[a.typeName]),"open"===a.defaultState&&this.addNewActiveBlade(a.typeName,"open")},closeBladeById:function(a){f(a);var b=_.find(e,function(b){return b.id===a});e.splice(e.indexOf(b),1)},closeBlade:function(a){f(a.id),e.splice(e.indexOf(a),1)},open:function(a,b,c,d){var g=_.find(e,function(b){return b.id===a});e.indexOf(g)<e.length-1&&f(a),this.addNewActiveBlade(b,"open",c,d)}}}]);