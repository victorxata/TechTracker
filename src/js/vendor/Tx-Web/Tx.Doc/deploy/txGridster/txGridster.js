"use strict";angular.module("baseApp.shared").directive("txGridster",["$compile",function(a){return{restrict:"E",scope:{layout:"=",columns:"@",margin:"@",active:"=",onChanged:"&"},link:function(b,c){var d,e=function(){b.onChanged&&b.onChanged({serializedData:d.serialize()})},f=c[0].clientWidth;if(d=c.find("ul").gridster({widget_base_dimensions:[Math.floor(f/b.columns-2*b.margin),200],widget_margins:[b.margin,b.margin],max_cols:b.columns,min_cols:b.columns,draggable:{stop:e},serialize_params:function(a,b){return{name:a.find("h1").html(),color:a.find("section").attr("color"),col:b.col,row:b.row,size_x:b.size_x,size_y:b.size_y}}}).data("gridster"),b.layout){var g=Gridster.sort_by_row_and_col_asc(b.layout);d.remove_all_widgets(),$.each(g,function(){var c=angular.element('<li><tx-widget title="'+this.name+'" color="'+this.color+'"></tx-widget></li>'),e=a(c);d.add_widget(c,this.size_x,this.size_y,this.col,this.row),e(b)})}b.$watch("active",function(a){a?(d.enable(),c.addClass("active")):(d.disable(),c.removeClass("active"))}),b.$watch("layout",function(c){c&&(d.remove_all_widgets(),$.each(c,function(){var c=angular.element('<li><tx-widget title="'+this.name+'" color="'+this.color+'"></tx-widget></li>'),e=a(c);d.add_widget(c,this.size_x,this.size_y,this.col,this.row),e(b)}))},!0)},controller:function(){},replace:!0,template:'<div class="gridster"><ul class="txGridster"></ul></div>'}}]);